# Welcome to Serverless!
#
# This file is the main config file for your service.
# It's very minimal at this point and uses default values.
# You can always add more config options for more control.
# We've included some commented out config examples here.
# Just uncomment any of them to get that config option.
#
# For full config options, check the docs:
#    docs.serverless.com
#
# Happy Coding!

service: firebase # NOTE: update this with your service name

custom: ${file(./config.${opt:stage, 'dev'}.yml)}

provider:
  name: aws
  runtime: nodejs8.10
  stage: ${opt:stage, 'dev'}
  region: ${self:custom.env.region}
  profile: ${self:custom.env.profile}
  environment:
    TOKEN_TOPIC_ARN: ${self:custom.sns.token-topic-arn}    
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - "sns:Publish"
        - "sns:Subscribe"
      Resource:
        - ${self:provider.environment.TOKEN_TOPIC_ARN}

functions:
  store:
    handler: handler.store
    events: # The Events that trigger this Function
      - sns: ${self:provider.environment.TOKEN_TOPIC_ARN}

  remove:
    handler: handler.remove
    events: # The Events that trigger this Function
      - sns: ${self:provider.environment.TOKEN_TOPIC_ARN}

  # process:
  #   handler: handler.process
  #   events: # The Events that trigger this Function
  #     - sns: ${self:provider.environment.TOKEN_TOPIC_ARN}
      